javascript:(function () { class Cell { constructor(row, col, board) { this.row = row; this.col = col; this.bomb = false; this.board = board; this.revealed = false; this.flagged = false; this.adjBombs = 0; } getAdjCells() { var cells = []; var lastRow = this.board.length - 1; var lastCol = this.board[0].length - 1; if (this.row > 0 && this.col > 0) cells.push(this.board[this.row - 1][this.col - 1]); if (this.row > 0) cells.push(this.board[this.row - 1][this.col]); if (this.row > 0 && this.col < lastCol) cells.push(this.board[this.row - 1][this.col + 1]); if (this.col < lastCol) cells.push(this.board[this.row][this.col + 1]); if (this.row < lastRow && this.col < lastCol) cells.push(this.board[this.row + 1][this.col + 1]); if (this.row < lastRow) cells.push(this.board[this.row + 1][this.col]); if (this.row < lastRow && this.col > 0) cells.push(this.board[this.row + 1][this.col - 1]); if (this.col > 0) cells.push(this.board[this.row][this.col - 1]); return cells; } calcAdjBombs() { var adjCells = this.getAdjCells(); this.adjBombs = adjCells.reduce((count, cell) => count + (cell.bomb ?%201%20:%200),%200);%20}%20flag()%20{%20if%20(!this.revealed)%20{%20this.flagged%20=%20!this.flagged;%20return%20this.flagged;%20}%20return%20false;%20}%20reveal()%20{%20if%20(this.revealed)%20return%20false;%20this.revealed%20=%20true;%20if%20(this.bomb)%20return%20true;%20if%20(this.adjBombs%20===%200)%20{%20this.getAdjCells().forEach(cell%20=%3E%20{%20if%20(!cell.revealed)%20cell.reveal();%20});%20}%20return%20false;%20}%20}%20var%20levels%20=%20{%20easy:%20{%20size:%209,%20bombs:%2010%20},%20mid:%20{%20size:%2016,%20bombs:%2040%20},%20hard:%20{%20size:%2030,%20bombs:%20160%20}%20};%20var%20currentLevel%20=%20levels.mid;%20var%20boardSize%20=%20currentLevel.size;%20var%20timerId,%20hitBomb,%20board,%20timer,%20bombCounter;%20var%20createBoard%20=%20()%20=%3E%20{%20var%20table%20=%20document.createElement(%27table%27);%20table.id%20=%20%27board%27;%20table.style.borderCollapse%20=%20%27collapse%27;%20table.style.margin%20=%20%27auto%27;%20table.style.position%20=%20%27fixed%27;%20table.style.top%20=%20%2750%%27;%20table.style.left%20=%20%2750%%27;%20table.style.transform%20=%20%27translate(-50%,%20-50%)%27;%20table.style.backgroundColor%20=%20%27#333';%20table.style.padding%20=%20'10px';%20table.style.border%20=%20'2px%20solid%20#666';%20table.style.zIndex%20=%20'10000';%20document.body.appendChild(table);%20return%20table;%20};%20var%20initGame%20=%20(level)%20=%3E%20{%20currentLevel%20=%20levels[level]%20||%20currentLevel;%20boardSize%20=%20currentLevel.size;%20clearInterval(timerId);%20board.innerHTML%20=%20'';%20var%20header%20=%20document.createElement('tr');%20var%20headerCell%20=%20document.createElement('td');%20headerCell.colSpan%20=%20boardSize;%20headerCell.style.textAlign%20=%20'center';%20headerCell.style.background%20=%20'#ccc';%20headerCell.style.color%20=%20'#000';%20var%20statusBar%20=%20document.createElement('div');%20statusBar.id%20=%20'status-bar';%20bombCounter%20=%20document.createElement('span');%20bombCounter.id%20=%20'bomb-counter';%20bombCounter.textContent%20=%20currentLevel.bombs.toString().padStart(3,%20'0');%20timer%20=%20document.createElement('span');%20timer.id%20=%20'timer';%20timer.textContent%20=%20'000';%20var%20resetButton%20=%20document.createElement('button');%20resetButton.id%20=%20'reset';%20resetButton.textContent%20=%20'%F0%9F%98%90';%20statusBar.appendChild(bombCounter);%20statusBar.appendChild(timer);%20statusBar.appendChild(resetButton);%20headerCell.appendChild(statusBar);%20header.appendChild(headerCell);%20board.appendChild(header);%20for%20(var%20i%20=%200;%20i%20%3C%20boardSize;%20i++)%20{%20var%20row%20=%20document.createElement('tr');%20for%20(var%20j%20=%200;%20j%20%3C%20boardSize;%20j++)%20{%20var%20cell%20=%20document.createElement('td');%20cell.classList.add('game-cell');%20cell.style.width%20=%20'20px';%20cell.style.height%20=%20'20px';%20cell.style.border%20=%20'1px%20solid%20#000';%20cell.style.background%20=%20'#aaa';%20cell.setAttribute('data-row',%20i);%20cell.setAttribute('data-col',%20j);%20row.appendChild(cell);%20}%20board.appendChild(row);%20}%20setupBoard();%20addEventListeners();%20startTimer();%20};%20var%20setupBoard%20=%20()%20=%3E%20{%20boardArray%20=%20Array(boardSize).fill(null).map(()%20=%3E%20Array(boardSize).fill(null));%20for%20(var%20i%20=%200;%20i%20%3C%20boardSize;%20i++)%20{%20for%20(var%20j%20=%200;%20j%20%3C%20boardSize;%20j++)%20{%20boardArray[i][j]%20=%20new%20Cell(i,%20j,%20boardArray);%20}%20}%20var%20bombsToPlace%20=%20currentLevel.bombs;%20while%20(bombsToPlace%20%3E%200)%20{%20var%20row%20=%20Math.floor(Math.random()%20*%20boardSize);%20var%20col%20=%20Math.floor(Math.random()%20*%20boardSize);%20if%20(!boardArray[row][col].bomb)%20{%20boardArray[row][col].bomb%20=%20true;%20bombsToPlace--;%20}%20}%20boardArray.forEach(row%20=%3E%20row.forEach(cell%20=%3E%20cell.calcAdjBombs()));%20};%20var%20addEventListeners%20=%20()%20=%3E%20{%20board.addEventListener('click',%20handleCellClick);%20board.addEventListener('contextmenu',%20handleCellRightClick);%20document.getElementById('reset').addEventListener('click',%20resetGame);%20document.addEventListener('keydown',%20handleKeyPress);%20};%20var%20handleCellClick%20=%20(event)%20=%3E%20{%20var%20target%20=%20event.target;%20if%20(target.tagName%20===%20'TD'%20&&%20!hitBomb)%20{%20var%20row%20=%20parseInt(target.getAttribute('data-row'));%20var%20col%20=%20parseInt(target.getAttribute('data-col'));%20hitBomb%20=%20boardArray[row][col].reveal();%20if%20(hitBomb)%20{%20document.getElementById('reset').textContent%20=%20'%F0%9F%98%9E';%20}%20else%20if%20(checkWin())%20{%20document.getElementById('reset').textContent%20=%20'%F0%9F%98%81';%20}%20updateBoard();%20}%20};%20var%20handleCellRightClick%20=%20(event)%20=%3E%20{%20event.preventDefault();%20var%20target%20=%20event.target;%20if%20(target.tagName%20===%20'TD')%20{%20var%20row%20=%20parseInt(target.getAttribute('data-row'));%20var%20col%20=%20parseInt(target.getAttribute('data-col'));%20boardArray[row][col].flag();%20updateBoard();%20}%20};%20var%20handleKeyPress%20=%20(event)%20=%3E%20{%20if%20(event.key%20===%20'1')%20{%20initGame('easy');%20}%20else%20if%20(event.key%20===%20'2')%20{%20initGame('mid');%20}%20else%20if%20(event.key%20===%20'3')%20{%20initGame('hard');%20}%20else%20if%20(event.key%20===%20'/')%20{%20toggleBoardVisibility();%20}%20};%20var%20toggleBoardVisibility%20=%20()%20=%3E%20{%20var%20boardElement%20=%20document.getElementById('board');%20if%20(boardElement.style.display%20===%20'none')%20{%20boardElement.style.display%20=%20'';%20}%20else%20{%20boardElement.style.display%20=%20'none';%20}%20};%20var%20updateBoard%20=%20()%20=%3E%20{%20var%20colors%20=%20[%22#0000FA%22,%20%22#4B802D%22,%20%22#DB1300%22,%20%22#202081%22,%20%22#690400%22,%20%22#457A7A%22,%20%22#1B1B1B%22,%20%22#7A7A7A%22];%20Array.from(document.querySelectorAll('td.game-cell')).forEach(cell%20=%3E%20{%20var%20row%20=%20parseInt(cell.getAttribute('data-row'));%20var%20col%20=%20parseInt(cell.getAttribute('data-col'));%20var%20boardCell%20=%20boardArray[row][col];%20if%20(boardCell.revealed)%20{%20cell.style.background%20=%20'#ddd';%20if%20(boardCell.bomb)%20{%20cell.style.background%20=%20'red';%20}%20else%20if%20(boardCell.adjBombs%20%3E%200)%20{%20cell.textContent%20=%20boardCell.adjBombs;%20cell.style.color%20=%20colors[boardCell.adjBombs%20-%201];%20}%20}%20else%20if%20(boardCell.flagged)%20{%20cell.textContent%20=%20'%F0%9F%9A%A9';%20}%20else%20{%20cell.textContent%20=%20'';%20}%20});%20};%20var%20resetGame%20=%20()%20=%3E%20{%20clearInterval(timerId);%20timerId%20=%20null;%20hitBomb%20=%20false;%20document.getElementById('reset').textContent%20=%20'%F0%9F%98%90';%20initGame(currentLevel);%20};%20var%20startTimer%20=%20()%20=%3E%20{%20var%20time%20=%200;%20timerId%20=%20setInterval(()%20=%3E%20{%20time%20+=%201;%20timer.textContent%20=%20time.toString().padStart(3,%20'0');%20},%201000);%20};%20var%20checkWin%20=%20()%20=%3E%20{%20return%20boardArray.every(row%20=%3E%20row.every(cell%20=%3E%20(cell.bomb%20&&%20!cell.revealed)%20||%20(!cell.bomb%20&&%20cell.revealed)));%20};%20var%20board%20=%20document.getElementById('board')%20||%20createBoard();%20initGame('mid');%20})();
